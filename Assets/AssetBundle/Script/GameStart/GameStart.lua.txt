GameStartManager = {}

-- 加载启动图
function GameStartManager:LoadImage()
    image = LoadManager:Load(ABManager:LoadAsset("prefeb", "Test"), "UI/CameraMask", false)
    CutToCtrl:BlackMaskAni(
        0,
        0.5,
        function()
            Core.timer = 2 -- 2秒后调用黑遮罩淡入
            Core.timerEvent = function()
                CutToCtrl:BlackMaskAni(
                    1,
                    0.5,
                    function()
                        self:LoadingBar()
                    end
                )
            end
        end
    )
end

-- 加载登录系统



local isLoadingFinish = false

-- 登录成功，加载进度条，加载所有数据
function GameStartManager:LoadingBar()
    -- 令镜头前的黑遮罩 失活
    CameraMask = CS.UnityEngine.GameObject.Find("UI/CameraMask")
    CameraMask:SetActive(false)

    -- 加载 玩家的本地数据，并合并成完整数据
    PlayerDataModel:ReadOut()
    -- Print 测试数据的读取是否成功
    print(PlayerDataModel.CompletePlayerData.Heros[1].Name)

    -- 加载 进度条
    LoadingPanel = LoadManager:Load(ABManager:LoadAsset("prefeb", "LoadingProcess"), "UI/Canvas", false)
    barImage = LoadingPanel.transform:Find("Bar").gameObject:GetComponent("Image")
    Core.countDown = 2
    local time = Core.countDown
    Core.cdEvent = function()
        barImage.fillAmount = 1 - Core.countDown/time
        if barImage.fillAmount == 1 then
            isLoadingFinish = true
            -- print(isLoadingFinish)
        end
    end
end



-- 进入游戏主场景

GameStartManager:LoadImage()
