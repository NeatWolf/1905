-- 详细信息窗口

DetailView = {}

DetailView.EquipList = nil
DetailView.Equipments = nil


-- 显示空装备
function DetailView:ShowEmptyEquip(index)
    DetailCtrl.EquipPanel.images[index].sprite = nil
    DetailCtrl.EquipPanel.images[index].color = CS.UnityEngine.Color(1,1,1,0.5)
    if index == 0 then
        DetailCtrl.EquipPanel.texts[index].text = "武器"
    elseif index == 1 then
        DetailCtrl.EquipPanel.texts[index].text = "頭盔"
    elseif index == 2 then
        DetailCtrl.EquipPanel.texts[index].text = "衣服"
    elseif index == 3 then
        DetailCtrl.EquipPanel.texts[index].text = "褲腿"
    elseif index == 4 then
        DetailCtrl.EquipPanel.texts[index].text = "鞋子"
    elseif index == 5 then
        DetailCtrl.EquipPanel.texts[index].text = "飾品"
    end
end


function DetailView:ShowDetail(heroData, equipList, equipments)

    -- 显示英雄简介
    DetailCtrl.IntroPanel.tmps[0].text = heroData.Description

    -- 显示上方装备列表（已装备）
    self.EquipList = equipList
    for i=1, 6 do
        if self.EquipList[i] ~= nil then
            DetailCtrl.EquipPanel.texts[i-1].text = ""
            DetailCtrl.EquipPanel.images[i-1].sprite = ABManager:LoadAsset("texture", self.EquipList[i].ItemID, CS.UnityEngine.Sprite)
            DetailCtrl.EquipPanel.images[i-1].color = CS.UnityEngine.Color(1,1,1,1)

            DetailCtrl.EquipPanel.buttons[i+1].onClick:AddListener(
                function()
                    heroData = DetailCtrl:EquipHero(heroData, self.EquipList[i], -1)
                    DetailCtrl:ShowDetailInfo(heroData)
                end
            )
        else
            self:ShowEmptyEquip(i-1)
        end
    end

    -- 显示下方装备列表（未装备）
    self.Equipments = {}
    LoadManager:DeleteAllChilds(DetailCtrl.EquipPanel.go[0])
    for k,v in pairs(equipments) do
        local _Equipment = UICtrl:LoadItem(
            v,
            DetailCtrl.EquipPanel.go[0].transform,
            function()
                -- 穿上装备
                heroData = DetailCtrl:EquipHero(heroData, v, 1)
                DetailCtrl:ShowDetailInfo(heroData)
            end
        )
        table.insert(self.Equipments, _Equipment)
    end

end


